# 2장  

## 데이터 전처리

- np.column_stack() , np.concatenate() 함수

[1,1,1] [0,0,0]
-> np.column_stack() :     
[ 1, 0  
  1, 0  
	1, 0 ] 

np.concatenate() : [ 1 1 1 0 0 0 ]  

- train_test_split() 함수  
: train_input, test_input, train_target, test_target = train_test_split(fish_data, fish_target, random_state = 42)
  의 경우 해석하면 fish_data를 train_input, test_input으로 2개를 나누게 되고
  fish_target을 train_target, test_target으로 나눈다.

> 기본적으로, 75%(3/4)는 train으로 25%(1/4)는 test 이다.

- train, test, validation 에 따른 내용  
: 전체 중에서 7:3 비율로 train과 test를 나눈다
test내부에서 1:2 비율로 val 과 test를 또 나눈다.

validatoin : 모델의 일반화 성능을 강화한다.(검증용 - test가 잘 섞여있는지 확인 가능)  
좀 더 많은 검증을 하게 된다.(더 많은 테스트를 진행하기 때문에)  
ex) val : 60% , test: 40% 경우 val이 모집단 train에 대해서 더 들어있다고 확인이 가능하다

- KNeighborsClassifier 클래스의 이웃 개수인 n_neighbors의 기본값은 5 이다.
  홀수의 숫자로 하는 이유는 voting 방식이기 때문에 홀수로 진행한다. 


### 용어 정리 
- 데이터 전처리 : 머신러닝 모델에 훈련 데이터를 주입하기 전에 가공하는 단계
  
- 브로드캐스팅 : 크기가 다른 넘파이 배열에서 자동으로 사칙 연산을 모든 행이나 열로 확장하여 수행하는 기능

### 핵심 패키지와 함수
> scikit-learn
- train_test_split() : 훈련 데이터를 훈련 세트와 테스트 세트로 나누는 함수이며, 체스트 세트로 나눌 비율은 test_size 매개변수에서 지정할 수 있으며,
  기본값은 0.25 이다.  
  shuffle 매개변수로 훈련 세트와 테스트 세트를 나누기 전에 무작위로 섞을지 여부를 결정할 수 있다. 기본값은 True이다.  
  stratify 매개변수에 클래스 레이블이 담긴 배열(일반적으로 타깃 데이터)을 전달하면 클래스 비율에 맞게 훈련 세트와 테스트 세트를 나누게 된다.  

- kneighbors() : k-최근접 이웃 객체의 매서드
  이 매서드는 입력한 데이터에 가장 가까운 이웃을 찾아 거리와 이웃 샘플의 인덱스를 반환한다. 기본적으로 이웃의 개수는 KNeighborsClassifier 클래스의 객체를 생성할 때 지정한 개수를 사용한다.  
return_distance 매개변수를 False로 지정하면 이웃 샘플의 인덱스만 반환하고 거리는 반환하지 않는다. 이 매개변수의 기본값은 True 이다.

### 질문

Q. 정규화 하는 것이 항상 옳은 것인가  
  
A. Standard가 무조건 옳은 것은 아니다.   
예를 들어, outlier에 약한편이다. 평균적으로 10 단위의 숫자에서 300이 들어오면 큰 영향을 받게 된다.  
데이터의 분포를 그려서 확인해야 한다. 또한 정규분포로 데이터를 맞추면 좋다.    
  
왜도가 있으면, 루트를 씌우거나 제곱을 해서 정규분포로 하는데 안되면 그냥 두기   
  
- stratify를 반영하는 것이 무조건 좋은것은 아니지만, 쓰는 것이 좋은 것 같다.
  (stratify는 기존 데이터를 나누기 것에 그치는 게 아니라, 클래스 분포 비율까지 맞춘다.)

- overfitting : 일반화 하기에 어렵다.

- 분산을 높이면서 설명력을 갖는것 -> 차원축소할때(PCA)

- 차원이 커질수록 knn을 사용하지 않는 이유 : 차원이 커지면 거리가 왜곡이 되면서 거리가 비슷비슷해지기 때문에

- PCA는 선형적이다.

- R^2 가 음수일때
: 평균적으로 맞추는 것에 비해, 모델이 설명을 잘 하지 못해서.

- adj R^2
: y = ax + b 
  
	-> 얼마나 간단하게 설명하였는지, 앞에있는 변수의 개수를 몇 개 사용하였는가, 몇개로 표현하였는가  
	(기본적으로 R^2 보다 같거나 작다)
